<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë“œë˜ê·¸ ì•¤ ë“œë¡­ í…ŒìŠ¤íŠ¸ ë„êµ¬</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 1200px;
      margin: 0 auto;
      padding: 20px;
      background: #f5f5f5;
    }

    .test-section {
      background: white;
      margin: 20px 0;
      padding: 20px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    .test-button {
      background: #007bff;
      color: white;
      border: none;
      padding: 10px 20px;
      margin: 5px;
      border-radius: 5px;
      cursor: pointer;
      font-size: 14px;
    }

    .test-button:hover {
      background: #0056b3;
    }

    .test-button.success {
      background: #28a745;
    }

    .test-button.danger {
      background: #dc3545;
    }

    .test-button.warning {
      background: #ffc107;
      color: #212529;
    }

    .log-container {
      background: #000;
      color: #00ff00;
      padding: 15px;
      border-radius: 5px;
      font-family: monospace;
      font-size: 12px;
      max-height: 300px;
      overflow-y: auto;
      margin-top: 10px;
    }

    .category-section {
      border-left: 4px solid #007bff;
      padding-left: 15px;
    }

    .status-indicator {
      display: inline-block;
      width: 12px;
      height: 12px;
      border-radius: 50%;
      margin-right: 8px;
    }

    .status-success {
      background: #28a745;
    }

    .status-warning {
      background: #ffc107;
    }

    .status-danger {
      background: #dc3545;
    }

    .status-info {
      background: #17a2b8;
    }
  </style>
</head>

<body>
  <h1>ğŸ§ª ë“œë˜ê·¸ ì•¤ ë“œë¡­ ê¸°ëŠ¥ ì¢…í•© í…ŒìŠ¤íŠ¸</h1>

  <div class="test-section">
    <h2>ğŸ“‹ í…ŒìŠ¤íŠ¸ ì²´í¬ë¦¬ìŠ¤íŠ¸</h2>
    <div id="checklist">
      <div id="check-console-log">
        <span class="status-indicator status-info"></span>
        1. ì½˜ì†” ë¡œê·¸ ì¶œë ¥ í™•ì¸ - <span id="log-status">ëŒ€ê¸° ì¤‘</span>
      </div>
      <div id="check-ui-reflection">
        <span class="status-indicator status-info"></span>
        2. ì¹´ë“œ UI ë°˜ì˜ í™•ì¸ - <span id="ui-status">ëŒ€ê¸° ì¤‘</span>
      </div>
      <div id="check-persistence">
        <span class="status-indicator status-info"></span>
        3. ìƒˆë¡œê³ ì¹¨ í›„ ìƒíƒœ ìœ ì§€ - <span id="persistence-status">ëŒ€ê¸° ì¤‘</span>
      </div>
      <div id="check-test-tools">
        <span class="status-indicator status-info"></span>
        4. í…ŒìŠ¤íŠ¸ ë„êµ¬ ì‘ë™ - <span id="tools-status">ëŒ€ê¸° ì¤‘</span>
      </div>
      <div id="check-cross-category">
        <span class="status-indicator status-info"></span>
        5. ë‹¤ë¥¸ ì¹´í…Œê³ ë¦¬ êµì°¨ í…ŒìŠ¤íŠ¸ - <span id="cross-status">ëŒ€ê¸° ì¤‘</span>
      </div>
    </div>
  </div>

  <div class="test-section category-section">
    <h2>ğŸ¯ References í˜ì´ì§€ í…ŒìŠ¤íŠ¸</h2>
    <button class="test-button" onclick="openPage('/ko/references')">References í˜ì´ì§€ ì—´ê¸°</button>
    <button class="test-button success" onclick="testReferences()">ìë™ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
    <button class="test-button warning" onclick="simulateReferencesTest()">ì‹œë®¬ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸</button>
    <button class="test-button danger" onclick="clearReferencesStorage()">ì €ì¥ ë°ì´í„° ì‚­ì œ</button>

    <div class="log-container" id="references-log"></div>
  </div>

  <div class="test-section category-section">
    <h2>ğŸ¨ Curtain í˜ì´ì§€ í…ŒìŠ¤íŠ¸</h2>
    <button class="test-button" onclick="openPage('/ko/curtain')">Curtain í˜ì´ì§€ ì—´ê¸°</button>
    <button class="test-button success" onclick="testCurtain()">ìë™ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
    <button class="test-button warning" onclick="simulateCurtainTest()">ì‹œë®¬ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸</button>
    <button class="test-button danger" onclick="clearCurtainStorage()">ì €ì¥ ë°ì´í„° ì‚­ì œ</button>

    <div class="log-container" id="curtain-log"></div>
  </div>

  <div class="test-section category-section">
    <h2>ğŸ¯ Blind í˜ì´ì§€ í…ŒìŠ¤íŠ¸</h2>
    <button class="test-button" onclick="openPage('/ko/blind')">Blind í˜ì´ì§€ ì—´ê¸°</button>
    <button class="test-button success" onclick="testBlind()">ìë™ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
    <button class="test-button warning" onclick="simulateBlindTest()">ì‹œë®¬ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸</button>
    <button class="test-button danger" onclick="clearBlindStorage()">ì €ì¥ ë°ì´í„° ì‚­ì œ</button>

    <div class="log-container" id="blind-log"></div>
  </div>

  <div class="test-section category-section">
    <h2>ğŸ¤– Motorized í˜ì´ì§€ í…ŒìŠ¤íŠ¸</h2>
    <button class="test-button" onclick="openPage('/ko/motorized')">Motorized í˜ì´ì§€ ì—´ê¸°</button>
    <button class="test-button success" onclick="testMotorized()">ìë™ í…ŒìŠ¤íŠ¸ ì‹¤í–‰</button>
    <button class="test-button warning" onclick="simulateMotorizedTest()">ì‹œë®¬ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸</button>
    <button class="test-button danger" onclick="clearMotorizedStorage()">ì €ì¥ ë°ì´í„° ì‚­ì œ</button>

    <div class="log-container" id="motorized-log"></div>
  </div>

  <div class="test-section">
    <h2>ğŸ”§ ì „ì²´ ì‹œìŠ¤í…œ ê´€ë¦¬</h2>
    <button class="test-button success" onclick="runFullTest()">ğŸš€ ì „ì²´ ìë™ í…ŒìŠ¤íŠ¸</button>
    <button class="test-button warning" onclick="checkAllStorage()">ğŸ’¾ ëª¨ë“  ì €ì¥ì†Œ í™•ì¸</button>
    <button class="test-button danger" onclick="clearAllStorage()">ğŸ—‘ï¸ ëª¨ë“  ì €ì¥ ë°ì´í„° ì‚­ì œ</button>
    <button class="test-button" onclick="exportTestResults()">ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë‚´ë³´ë‚´ê¸°</button>

    <div class="log-container" id="system-log"></div>
  </div>

  <script>
    // ë¡œê·¸ ì¶œë ¥ í•¨ìˆ˜
    function log(category, message, type = 'info') {
      const container = document.getElementById(`${category}-log`);
      const timestamp = new Date().toLocaleTimeString();
      const typeColor = {
        'info': '#00ff00',
        'warn': '#ffff00',
        'error': '#ff0000',
        'success': '#00ff88'
      };

      if (container) {
        container.innerHTML += `<div style="color: ${typeColor[type] || '#00ff00'}">
                    [${timestamp}] ${message}
                </div>`;
        container.scrollTop = container.scrollHeight;
      }
    }

    // í˜ì´ì§€ ì—´ê¸°
    function openPage(path) {
      const url = `http://localhost:3003${path}`;
      log('system', `í˜ì´ì§€ ì—´ê¸°: ${url}`, 'info');
      window.open(url, '_blank');
    }

    // References í…ŒìŠ¤íŠ¸
    function testReferences() {
      log('references', 'ğŸ§ª References í…ŒìŠ¤íŠ¸ ì‹œì‘', 'info');

      // ìƒˆ ì°½ì—ì„œ References í˜ì´ì§€ ì—´ê¸°
      const testWindow = window.open('http://localhost:3003/ko/references', 'references-test');

      // í˜ì´ì§€ ë¡œë“œ ëŒ€ê¸° í›„ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
      setTimeout(() => {
        if (testWindow && !testWindow.closed) {
          try {
            // í…ŒìŠ¤íŠ¸ í•¨ìˆ˜ ì‹¤í–‰
            if (testWindow.testReferencesDragDrop) {
              testWindow.testReferencesDragDrop();
              log('references', 'âœ… testReferencesDragDrop() ì‹¤í–‰ ì™„ë£Œ', 'success');
            } else {
              log('references', 'âŒ testReferencesDragDrop() í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ', 'error');
            }
          } catch (error) {
            log('references', `âŒ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì˜¤ë¥˜: ${error.message}`, 'error');
          }
        } else {
          log('references', 'âŒ í…ŒìŠ¤íŠ¸ ì°½ì„ ì—´ ìˆ˜ ì—†ìŒ', 'error');
        }
      }, 3000);
    }

    // References ì‹œë®¬ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸
    function simulateReferencesTest() {
      log('references', 'ğŸ­ References ì‹œë®¬ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸ ì‹œì‘', 'info');

      const testWindow = window.open('http://localhost:3003/ko/references', 'references-simulate');

      setTimeout(() => {
        if (testWindow && !testWindow.closed) {
          try {
            if (testWindow.simulateReferencesImageDrop) {
              testWindow.simulateReferencesImageDrop(0);
              log('references', 'âœ… simulateReferencesImageDrop(0) ì‹¤í–‰ ì™„ë£Œ', 'success');

              // 3ì´ˆ í›„ ê²°ê³¼ í™•ì¸
              setTimeout(() => {
                if (testWindow.manageReferencesStorage) {
                  const storage = testWindow.manageReferencesStorage.list();
                  log('references', `ğŸ’¾ ì €ì¥ëœ ì´ë¯¸ì§€: ${Object.keys(storage).length}ê°œ`, 'info');
                }
              }, 3000);
            } else {
              log('references', 'âŒ simulateReferencesImageDrop() í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ', 'error');
            }
          } catch (error) {
            log('references', `âŒ ì‹œë®¬ë ˆì´ì…˜ ì˜¤ë¥˜: ${error.message}`, 'error');
          }
        }
      }, 3000);
    }

    // References ì €ì¥ì†Œ ì‚­ì œ
    function clearReferencesStorage() {
      try {
        localStorage.removeItem('dragdrop_references_images');
        log('references', 'ğŸ—‘ï¸ References ì €ì¥ ë°ì´í„° ì‚­ì œ ì™„ë£Œ', 'success');
      } catch (error) {
        log('references', `âŒ ì €ì¥ì†Œ ì‚­ì œ ì˜¤ë¥˜: ${error.message}`, 'error');
      }
    }

    // Curtain í…ŒìŠ¤íŠ¸ (Referencesì™€ ë™ì¼í•œ íŒ¨í„´)
    function testCurtain() {
      log('curtain', 'ğŸ§ª Curtain í…ŒìŠ¤íŠ¸ ì‹œì‘', 'info');
      const testWindow = window.open('http://localhost:3003/ko/curtain', 'curtain-test');
      setTimeout(() => {
        if (testWindow && !testWindow.closed) {
          try {
            if (testWindow.testCurtainDragDrop) {
              testWindow.testCurtainDragDrop();
              log('curtain', 'âœ… testCurtainDragDrop() ì‹¤í–‰ ì™„ë£Œ', 'success');
            } else {
              log('curtain', 'âŒ testCurtainDragDrop() í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ', 'error');
            }
          } catch (error) {
            log('curtain', `âŒ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì˜¤ë¥˜: ${error.message}`, 'error');
          }
        }
      }, 3000);
    }

    function simulateCurtainTest() {
      log('curtain', 'ğŸ­ Curtain ì‹œë®¬ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸ ì‹œì‘', 'info');
      const testWindow = window.open('http://localhost:3003/ko/curtain', 'curtain-simulate');
      setTimeout(() => {
        if (testWindow && !testWindow.closed) {
          try {
            if (testWindow.simulateCurtainImageDrop) {
              testWindow.simulateCurtainImageDrop(0);
              log('curtain', 'âœ… simulateCurtainImageDrop(0) ì‹¤í–‰ ì™„ë£Œ', 'success');
            } else {
              log('curtain', 'âŒ simulateCurtainImageDrop() í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ', 'error');
            }
          } catch (error) {
            log('curtain', `âŒ ì‹œë®¬ë ˆì´ì…˜ ì˜¤ë¥˜: ${error.message}`, 'error');
          }
        }
      }, 3000);
    }

    function clearCurtainStorage() {
      try {
        localStorage.removeItem('dragdrop_curtain_images');
        log('curtain', 'ğŸ—‘ï¸ Curtain ì €ì¥ ë°ì´í„° ì‚­ì œ ì™„ë£Œ', 'success');
      } catch (error) {
        log('curtain', `âŒ ì €ì¥ì†Œ ì‚­ì œ ì˜¤ë¥˜: ${error.message}`, 'error');
      }
    }

    // Blind í…ŒìŠ¤íŠ¸
    function testBlind() {
      log('blind', 'ğŸ§ª Blind í…ŒìŠ¤íŠ¸ ì‹œì‘', 'info');
      const testWindow = window.open('http://localhost:3003/ko/blind', 'blind-test');
      setTimeout(() => {
        if (testWindow && !testWindow.closed) {
          try {
            if (testWindow.testBlindDragDrop) {
              testWindow.testBlindDragDrop();
              log('blind', 'âœ… testBlindDragDrop() ì‹¤í–‰ ì™„ë£Œ', 'success');
            } else {
              log('blind', 'âŒ testBlindDragDrop() í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ', 'error');
            }
          } catch (error) {
            log('blind', `âŒ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì˜¤ë¥˜: ${error.message}`, 'error');
          }
        }
      }, 3000);
    }

    function simulateBlindTest() {
      log('blind', 'ğŸ­ Blind ì‹œë®¬ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸ ì‹œì‘', 'info');
      const testWindow = window.open('http://localhost:3003/ko/blind', 'blind-simulate');
      setTimeout(() => {
        if (testWindow && !testWindow.closed) {
          try {
            if (testWindow.simulateBlindImageDrop) {
              testWindow.simulateBlindImageDrop(0);
              log('blind', 'âœ… simulateBlindImageDrop(0) ì‹¤í–‰ ì™„ë£Œ', 'success');
            } else {
              log('blind', 'âŒ simulateBlindImageDrop() í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ', 'error');
            }
          } catch (error) {
            log('blind', `âŒ ì‹œë®¬ë ˆì´ì…˜ ì˜¤ë¥˜: ${error.message}`, 'error');
          }
        }
      }, 3000);
    }

    function clearBlindStorage() {
      try {
        localStorage.removeItem('dragdrop_blind_images');
        log('blind', 'ğŸ—‘ï¸ Blind ì €ì¥ ë°ì´í„° ì‚­ì œ ì™„ë£Œ', 'success');
      } catch (error) {
        log('blind', `âŒ ì €ì¥ì†Œ ì‚­ì œ ì˜¤ë¥˜: ${error.message}`, 'error');
      }
    }

    // Motorized í…ŒìŠ¤íŠ¸
    function testMotorized() {
      log('motorized', 'ğŸ§ª Motorized í…ŒìŠ¤íŠ¸ ì‹œì‘', 'info');
      const testWindow = window.open('http://localhost:3003/ko/motorized', 'motorized-test');
      setTimeout(() => {
        if (testWindow && !testWindow.closed) {
          try {
            if (testWindow.testMotorizedDragDrop) {
              testWindow.testMotorizedDragDrop();
              log('motorized', 'âœ… testMotorizedDragDrop() ì‹¤í–‰ ì™„ë£Œ', 'success');
            } else {
              log('motorized', 'âŒ testMotorizedDragDrop() í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ', 'error');
            }
          } catch (error) {
            log('motorized', `âŒ í…ŒìŠ¤íŠ¸ ì‹¤í–‰ ì˜¤ë¥˜: ${error.message}`, 'error');
          }
        }
      }, 3000);
    }

    function simulateMotorizedTest() {
      log('motorized', 'ğŸ­ Motorized ì‹œë®¬ë ˆì´ì…˜ í…ŒìŠ¤íŠ¸ ì‹œì‘', 'info');
      const testWindow = window.open('http://localhost:3003/ko/motorized', 'motorized-simulate');
      setTimeout(() => {
        if (testWindow && !testWindow.closed) {
          try {
            if (testWindow.simulateMotorizedImageDrop) {
              testWindow.simulateMotorizedImageDrop(0);
              log('motorized', 'âœ… simulateMotorizedImageDrop(0) ì‹¤í–‰ ì™„ë£Œ', 'success');
            } else {
              log('motorized', 'âŒ simulateMotorizedImageDrop() í•¨ìˆ˜ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŒ', 'error');
            }
          } catch (error) {
            log('motorized', `âŒ ì‹œë®¬ë ˆì´ì…˜ ì˜¤ë¥˜: ${error.message}`, 'error');
          }
        }
      }, 3000);
    }

    function clearMotorizedStorage() {
      try {
        localStorage.removeItem('dragdrop_motorized_images');
        log('motorized', 'ğŸ—‘ï¸ Motorized ì €ì¥ ë°ì´í„° ì‚­ì œ ì™„ë£Œ', 'success');
      } catch (error) {
        log('motorized', `âŒ ì €ì¥ì†Œ ì‚­ì œ ì˜¤ë¥˜: ${error.message}`, 'error');
      }
    }

    // ì „ì²´ ì‹œìŠ¤í…œ ê´€ë¦¬
    function runFullTest() {
      log('system', 'ğŸš€ ì „ì²´ ìë™ í…ŒìŠ¤íŠ¸ ì‹œì‘', 'info');

      // ìˆœì°¨ì ìœ¼ë¡œ ëª¨ë“  ì¹´í…Œê³ ë¦¬ í…ŒìŠ¤íŠ¸
      setTimeout(() => testReferences(), 1000);
      setTimeout(() => testCurtain(), 3000);
      setTimeout(() => testBlind(), 5000);
      setTimeout(() => testMotorized(), 7000);

      setTimeout(() => {
        log('system', 'âœ… ì „ì²´ í…ŒìŠ¤íŠ¸ ì™„ë£Œ', 'success');
      }, 10000);
    }

    function checkAllStorage() {
      log('system', 'ğŸ’¾ ëª¨ë“  ì €ì¥ì†Œ í™•ì¸ ì¤‘...', 'info');

      const categories = ['references', 'curtain', 'blind', 'motorized'];
      let totalImages = 0;

      categories.forEach(category => {
        try {
          const storageKey = `dragdrop_${category}_images`;
          const data = localStorage.getItem(storageKey);
          if (data) {
            const parsed = JSON.parse(data);
            const count = Object.keys(parsed).length;
            totalImages += count;
            log('system', `ğŸ“¦ ${category}: ${count}ê°œ ì´ë¯¸ì§€ ì €ì¥ë¨`, 'info');
          } else {
            log('system', `ğŸ“¦ ${category}: ì €ì¥ëœ ì´ë¯¸ì§€ ì—†ìŒ`, 'info');
          }
        } catch (error) {
          log('system', `âŒ ${category} ì €ì¥ì†Œ í™•ì¸ ì˜¤ë¥˜: ${error.message}`, 'error');
        }
      });

      log('system', `ğŸ“Š ì´ ì €ì¥ëœ ì´ë¯¸ì§€: ${totalImages}ê°œ`, 'success');
    }

    function clearAllStorage() {
      if (confirm('ëª¨ë“  ì¹´í…Œê³ ë¦¬ì˜ ì €ì¥ëœ ì´ë¯¸ì§€ë¥¼ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?')) {
        const categories = ['references', 'curtain', 'blind', 'motorized'];

        categories.forEach(category => {
          try {
            localStorage.removeItem(`dragdrop_${category}_images`);
            log('system', `ğŸ—‘ï¸ ${category} ì €ì¥ ë°ì´í„° ì‚­ì œ ì™„ë£Œ`, 'success');
          } catch (error) {
            log('system', `âŒ ${category} ì‚­ì œ ì˜¤ë¥˜: ${error.message}`, 'error');
          }
        });

        log('system', 'âœ… ëª¨ë“  ì €ì¥ ë°ì´í„° ì‚­ì œ ì™„ë£Œ', 'success');
      }
    }

    function exportTestResults() {
      const results = {
        timestamp: new Date().toISOString(),
        localStorage: {},
        testStatus: {
          consoleLog: document.getElementById('log-status').textContent,
          uiReflection: document.getElementById('ui-status').textContent,
          persistence: document.getElementById('persistence-status').textContent,
          testTools: document.getElementById('tools-status').textContent,
          crossCategory: document.getElementById('cross-status').textContent
        }
      };

      // localStorage ë°ì´í„° ìˆ˜ì§‘
      const categories = ['references', 'curtain', 'blind', 'motorized'];
      categories.forEach(category => {
        try {
          const data = localStorage.getItem(`dragdrop_${category}_images`);
          results.localStorage[category] = data ? JSON.parse(data) : null;
        } catch (error) {
          results.localStorage[category] = { error: error.message };
        }
      });

      // JSON íŒŒì¼ë¡œ ë‹¤ìš´ë¡œë“œ
      const blob = new Blob([JSON.stringify(results, null, 2)], { type: 'application/json' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `dragdrop-test-results-${Date.now()}.json`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);

      log('system', 'ğŸ“Š í…ŒìŠ¤íŠ¸ ê²°ê³¼ ë‚´ë³´ë‚´ê¸° ì™„ë£Œ', 'success');
    }

    // í˜ì´ì§€ ë¡œë“œ ì‹œ ì´ˆê¸° ìƒíƒœ í™•ì¸
    window.addEventListener('load', () => {
      log('system', 'ğŸ”§ ë“œë˜ê·¸ ì•¤ ë“œë¡­ í…ŒìŠ¤íŠ¸ ë„êµ¬ ì´ˆê¸°í™” ì™„ë£Œ', 'success');
      checkAllStorage();
    });
  </script>
</body>

</html>